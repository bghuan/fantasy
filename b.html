<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>My Chatbot</title>
    <style>
        /* CSS 样式定义 */
    </style>
</head>

<body>
    <h1>My Chatbot</h1>
    <p>输入文本，让我们对话吧！</p>
    <input type="text" id="input-text">
    <button id="submit-button">发送</button>
    <div id="chat-log">
        <!-- 聊天记录显示区域 -->
    </div>
    <div id="loading">
        <!-- 等待动画显示区域 -->
    </div>
    <script>
        // 当页面加载完成后执行
        window.addEventListener('load', function () {
            // 获取页面元素
            var input = document.getElementById('input-text');
            var submit = document.getElementById('submit-button');
            var chatLog = document.getElementById('chat-log');
            var loading = document.getElementById('loading');

            function getReply(inputText) {
                // 显示等待动画
                loading.style.display = 'block';

                // 调用 chatgpt 的 API 获取回复
                var xhr = new XMLHttpRequest();
                xhr.open('POST', 'https://api.openai.com/v1/completions');

                // 设置 HTTP 请求头
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.setRequestHeader('Authorization', 'Bearer sk-TaC6CFirq5SwFkfgfe9*********Yl3fkr8uu');
                xhr.onload = function () {
                    if (xhr.status === 200) {
                        // 解析响应数据
                        var response = JSON.parse(xhr.responseText);

                        // 将回复显示在网页上
                        var replyText = response.choices[0].text;
                        var p = document.createElement('p');
                        p.innerText = replyText;
                        chatLog.appendChild(p);
                    } else {
                        // 处理错误情况
                    }

                    // 隐藏等待动画
                    loading.style.display = 'none';
                };
                
                // 创建一个 JSON 对象，包含请求参数
                var data = {
                    prompt: 'User: ' + text,
                    model: 'text-davinci-002',
                    max_tokens: 256,
                    temperature: 0.5
                };
                xhr.send(JSON.stringify(data));
            }

            submit.addEventListener('click', function () {
                // 获取用户输入
                var inputText = input.value;

                // 调用 getReply() 函数获取回复
                getReply(inputText);
            });
        })
    </script>
</body>

</html>